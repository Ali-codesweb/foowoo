{"ast":null,"code":"import axios from \"axios\";\nimport { USER_LOGIN_FAIL, USER_LOGIN_REQUEST, USER_LOGIN_SUCCESS, USER_LOGOUT, USER_SIGNUP_FAIL, USER_SIGNUP_REQUEST, USER_SIGNUP_SUCCESS, USER_DONATE_REQUEST, USER_DONATE_SUCCESS, USER_DONATE_FAIL } from \"../constants/userConstants\";\nconst URL = 'http://127.0.0.1:8000';\nexport const login = (email, password) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  try {\n    dispatch({\n      type: USER_LOGIN_REQUEST\n    });\n    const {\n      data\n    } = await axios.post(URL + '/api/user/login/', {\n      'username': email,\n      'password': password,\n      config\n    });\n\n    if (data.is_user) {\n      dispatch({\n        type: USER_LOGIN_SUCCESS,\n        payload: data\n      });\n      localStorage.setItem('userInfo', JSON.stringify(data));\n    } else {\n      dispatch({\n        type: USER_LOGIN_FAIL,\n        payload: 'You are registered as restaurant. Please login as a Restaurant'\n      });\n    }\n  } catch (err) {\n    dispatch({\n      type: USER_LOGIN_FAIL,\n      payload: 'Invalid Credentials, please enter corrent email and password'\n    });\n  }\n};\nexport const logout = () => dispatch => {\n  dispatch({\n    type: USER_LOGOUT\n  });\n  localStorage.removeItem('userInfo');\n};\nexport const loginRestaurant = (email, password) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  try {\n    dispatch({\n      type: USER_LOGIN_REQUEST\n    });\n    const {\n      data\n    } = await axios.post(URL + '/api/user/login/', {\n      'username': email,\n      'password': password,\n      config\n    });\n\n    if (data.is_restaurant) {\n      dispatch({\n        type: USER_LOGIN_SUCCESS,\n        payload: data\n      });\n      localStorage.setItem('userInfo', JSON.stringify(data));\n    } else {\n      dispatch({\n        type: USER_LOGIN_FAIL,\n        payload: 'You are registered as user. Please login as a user'\n      });\n    }\n  } catch (err) {\n    dispatch({\n      type: USER_LOGIN_FAIL,\n      payload: 'Invalid Credentials, please enter corrent email and password'\n    });\n  }\n};\nexport const register = (email, first_name, last_name, password) => async dispatch => {\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n\n  try {\n    dispatch({\n      type: USER_SIGNUP_REQUEST\n    });\n    const {\n      data\n    } = await axios.post(URL + '/api/user/register/', {\n      'email': email,\n      'first_name': first_name,\n      'last_name': last_name,\n      'password': password,\n      config\n    });\n    dispatch({\n      type: USER_SIGNUP_SUCCESS,\n      payload: data\n    });\n    console.log('success');\n  } catch (err) {\n    dispatch({\n      type: USER_SIGNUP_FAIL,\n      payload: err.message\n    });\n  }\n};\nexport const donateMeal = (restaurant_id, serving_id, quantity) => async (dispatch, getState) => {\n  const token = localStorage.getItem('userInfo').token;\n  console.log(token);\n  console.log('token');\n  const config = {\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${token}`\n    }\n  };\n\n  try {\n    console.log(getState());\n    dispatch({\n      type: USER_DONATE_REQUEST\n    });\n    const {\n      data\n    } = await axios.post(`${URL}/api/user/donate/`, {\n      'restaurant_id': restaurant_id,\n      'serving_id': serving_id,\n      'quantity': quantity,\n      config\n    });\n    dispatch({\n      type: USER_DONATE_SUCCESS,\n      payload: data\n    });\n    console.log(JSON.parse(localStorage.getItem('userInfo')).token);\n    window.alert(`You have successfully donated. We are very grateful\n         of you ! You will be informed when your donation is accepted`);\n  } catch (err) {\n    dispatch({\n      type: USER_DONATE_FAIL,\n      payload: err.message\n    });\n    window.alert(err.message);\n  }\n};","map":{"version":3,"sources":["E:/Full HTML/Django-react/foowoo/frontend2/src/actions/userActions.js"],"names":["axios","USER_LOGIN_FAIL","USER_LOGIN_REQUEST","USER_LOGIN_SUCCESS","USER_LOGOUT","USER_SIGNUP_FAIL","USER_SIGNUP_REQUEST","USER_SIGNUP_SUCCESS","USER_DONATE_REQUEST","USER_DONATE_SUCCESS","USER_DONATE_FAIL","URL","login","email","password","dispatch","config","headers","type","data","post","is_user","payload","localStorage","setItem","JSON","stringify","err","logout","removeItem","loginRestaurant","is_restaurant","register","first_name","last_name","console","log","message","donateMeal","restaurant_id","serving_id","quantity","getState","token","getItem","Authorization","parse","window","alert"],"mappings":"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","sourcesContent":["import axios from \"axios\"\r\nimport {\r\n    USER_LOGIN_FAIL,\r\n    USER_LOGIN_REQUEST,\r\n    USER_LOGIN_SUCCESS,\r\n    USER_LOGOUT,\r\n    USER_SIGNUP_FAIL,\r\n    USER_SIGNUP_REQUEST,\r\n    USER_SIGNUP_SUCCESS,\r\n\r\n\r\n    USER_DONATE_REQUEST,\r\n    USER_DONATE_SUCCESS,\r\n    USER_DONATE_FAIL\r\n\r\n} from \"../constants/userConstants\"\r\n\r\n\r\nconst URL = 'http://127.0.0.1:8000'\r\n\r\n\r\n\r\nexport const login = (email, password) => async (dispatch) => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n    }\r\n    try {\r\n        dispatch({\r\n            type: USER_LOGIN_REQUEST\r\n        })\r\n        const { data } = await axios.post(URL + '/api/user/login/', {\r\n            'username': email,\r\n            'password': password,\r\n            config\r\n        })\r\n        if (data.is_user) {\r\n            dispatch({\r\n                type: USER_LOGIN_SUCCESS,\r\n                payload: data\r\n            })\r\n            localStorage.setItem('userInfo', JSON.stringify(data))\r\n        } else {\r\n            dispatch({\r\n                type: USER_LOGIN_FAIL,\r\n                payload: 'You are registered as restaurant. Please login as a Restaurant'\r\n            })\r\n        }\r\n\r\n\r\n\r\n    } catch (err) {\r\n        dispatch({\r\n            type: USER_LOGIN_FAIL,\r\n            payload: 'Invalid Credentials, please enter corrent email and password'\r\n        })\r\n    }\r\n}\r\n\r\nexport const logout = () => (dispatch) => {\r\n    dispatch({\r\n        type: USER_LOGOUT\r\n    })\r\n    localStorage.removeItem('userInfo')\r\n}\r\n\r\nexport const loginRestaurant = (email, password) => async (dispatch) => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n    }\r\n    try {\r\n        dispatch({\r\n            type: USER_LOGIN_REQUEST\r\n        })\r\n        const { data } = await axios.post(URL + '/api/user/login/', {\r\n            'username': email,\r\n            'password': password,\r\n            config\r\n        })\r\n        if (data.is_restaurant) {\r\n            dispatch({\r\n                type: USER_LOGIN_SUCCESS,\r\n                payload: data\r\n            })\r\n            localStorage.setItem('userInfo', JSON.stringify(data))\r\n        } else {\r\n            dispatch({\r\n                type: USER_LOGIN_FAIL,\r\n                payload: 'You are registered as user. Please login as a user'\r\n            })\r\n        }\r\n\r\n\r\n\r\n    } catch (err) {\r\n        dispatch({\r\n            type: USER_LOGIN_FAIL,\r\n            payload: 'Invalid Credentials, please enter corrent email and password'\r\n        })\r\n    }\r\n}\r\n\r\nexport const register = (email, first_name, last_name, password) => async (dispatch) => {\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json'\r\n        },\r\n    }\r\n    try {\r\n        dispatch({\r\n            type: USER_SIGNUP_REQUEST\r\n        })\r\n        const { data } = await axios.post(URL + '/api/user/register/', {\r\n            'email': email,\r\n            'first_name': first_name,\r\n            'last_name': last_name,\r\n            'password': password,\r\n            config\r\n        })\r\n        dispatch({\r\n            type: USER_SIGNUP_SUCCESS,\r\n            payload: data\r\n        })\r\n\r\n        console.log('success')\r\n\r\n    } catch (err) {\r\n        dispatch({\r\n            type: USER_SIGNUP_FAIL,\r\n            payload: err.message\r\n        })\r\n    }\r\n}\r\n\r\nexport const donateMeal = (restaurant_id, serving_id,quantity) => async (dispatch,getState) => {\r\n    const token = localStorage.getItem('userInfo').token\r\n    console.log(token)\r\n    console.log('token')\r\n    const config = {\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            Authorization: `Bearer ${token}`\r\n        }\r\n    }\r\n    try {\r\n        console.log(getState())\r\n        dispatch({\r\n            type:USER_DONATE_REQUEST\r\n        })\r\n\r\n        const { data } = await axios.post(`${URL}/api/user/donate/`, {\r\n            'restaurant_id': restaurant_id,\r\n            'serving_id': serving_id,\r\n            'quantity':quantity,\r\n            config\r\n        })\r\n\r\n        dispatch({\r\n            type:USER_DONATE_SUCCESS,\r\n            payload : data\r\n        })\r\n        console.log(JSON.parse(localStorage.getItem('userInfo')).token)\r\n\r\n        window.alert(`You have successfully donated. We are very grateful\r\n         of you ! You will be informed when your donation is accepted`)\r\n\r\n    } catch (err) {\r\n        dispatch({\r\n            type:USER_DONATE_FAIL,\r\n            payload : err.message\r\n        })\r\n\r\n        window.alert(err.message)\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}